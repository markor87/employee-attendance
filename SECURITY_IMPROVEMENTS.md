# –ë–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∞ –ø–æ–±–æ—ô—à–∞—ö–∞ - –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞

## ‚úÖ –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–æ

### 1. Rate Limiting
- **Login endpoint:** –ú–∞–∫—Å–∏–º—É–º 5 –ø–æ–∫—É—à–∞—ò–∞ –ø–æ –º–∏–Ω—É—Ç–∏
- **2FA verify:** –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–∫—É—à–∞—ò–∞ –ø–æ –º–∏–Ω—É—Ç–∏
- **2FA resend:** –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–∫—É—à–∞—ò–∞ –Ω–∞ 10 –º–∏–Ω—É—Ç–∞

### 2. User Enumeration - –ü–æ–ø—Ä–∞–≤—ô–µ–Ω–æ
- –ì–µ–Ω–µ—Ä–∏—á–∫–∞ error –ø–æ—Ä—É–∫–∞: "–ù–µ–∏—Å–ø—Ä–∞–≤–∞–Ω email –∏–ª–∏ –ª–æ–∑–∏–Ω–∫–∞"
- –ù–µ–º–∞ —Ä–∞–∑–ª–∏–∫–µ –∏–∑–º–µ—í—É "–∫–æ—Ä–∏—Å–Ω–∏–∫ –Ω–µ –ø–æ—Å—Ç–æ—ò–∏" –∏ "–ª–æ—à–∞ –ª–æ–∑–∏–Ω–∫–∞"

### 3. Account Lockout
- –ö—Ä–µ–∏—Ä–∞–Ω–∞ `failed_login_attempts` —Ç–∞–±–µ–ª–∞
- `LoginAttemptService` –∑–∞ tracking –Ω–µ—É—Å–ø–µ–ª–∏—Ö –ø–æ–∫—É—à–∞—ò–∞
- –ù–∞–ª–æ–≥ –∑–∞–∫—ô—É—á–∞–Ω –ø–æ—Å–ª–µ **5 –Ω–µ—É—Å–ø–µ–ª–∏—Ö –ø–æ–∫—É—à–∞—ò–∞**
- –ê—É—Ç–æ–º–∞—Ç—Å–∫–∏ unlock –ø–æ—Å–ª–µ **15 –º–∏–Ω—É—Ç–∞**

### 4. Security Headers
- `Strict-Transport-Security` - –§–æ—Ä—Å–∏—Ä–∞ HTTPS
- `X-Frame-Options: SAMEORIGIN` - –°–ø—Ä–µ—á–∞–≤–∞ clickjacking
- `X-Content-Type-Options: nosniff` - –°–ø—Ä–µ—á–∞–≤–∞ MIME sniffing
- `X-XSS-Protection` - –ê–∫—Ç–∏–≤–∏—Ä–∞ XSS –∑–∞—à—Ç–∏—Ç—É
- `Referrer-Policy` - –ö–æ–Ω—Ç—Ä–æ–ª–∏—à–µ referrer –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ
- `Content-Security-Policy` - –ö–æ–Ω—Ç—Ä–æ–ª–∏—à–µ —É—á–∏—Ç–∞–≤–∞—ö–µ —Ä–µ—Å—É—Ä—Å–∞
- `Permissions-Policy` - –ö–æ–Ω—Ç—Ä–æ–ª–∏—à–µ browser features

---

## üìù –ü–û–¢–†–ï–ë–ù–ï –ü–†–û–ú–ï–ù–ï –£ `.env` –§–ê–à–õ–£

### 1. –û–º–æ–≥—É—õ–∏—Ç–∏ Session Encryption
–ü—Ä–æ–Ω–∞—í–∏—Ç–µ –∏ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ:
```env
SESSION_ENCRYPT=false
```
–£:
```env
SESSION_ENCRYPT=true
```

### 2. (–û–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ) –°–º–∞—ö–∏—Ç–∏ Session Lifetime
–¢—Ä–µ–Ω—É—Ç–Ω–æ —ò–µ 120 –º–∏–Ω—É—Ç–∞. –†–∞–∑–º–∏—Å–ª–∏—Ç–µ –æ —Å–º–∞—ö–µ—ö—É –Ω–∞ 60:
```env
SESSION_LIFETIME=60
```

---

## üóÑÔ∏è –ú–ò–ì–†–ê–¶–ò–à–ê –ë–ê–ó–ï

–ü–æ–∫—Ä–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—ò—É –∑–∞ `failed_login_attempts` —Ç–∞–±–µ–ª—É:
```bash
php artisan migrate
```

–û–≤–æ —õ–µ –∫—Ä–µ–∏—Ä–∞—Ç–∏ —Ç–∞–±–µ–ª—É:
- `id` - Primary key
- `email` - Email –∞–¥—Ä–µ—Å–∞
- `ip_address` - IP –∞–¥—Ä–µ—Å–∞
- `attempted_at` - –í—Ä–µ–º–µ –ø–æ–∫—É—à–∞—ò–∞

---

## üß™ –¢–ï–°–¢–ò–†–ê–ä–ï

### –¢–µ—Å—Ç–∏—Ä–∞—ö–µ Rate Limiting-–∞:
1. –ü–æ–∫—É—à–∞—ò—Ç–µ –¥–∞ —Å–µ –ø—Ä–∏—ò–∞–≤–∏—Ç–µ 6 –ø—É—Ç–∞ —É–∑–∞—Å—Ç–æ–ø–Ω–æ
2. –¢—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ –≤–∏–¥–∏—Ç–µ –≥—Ä–µ—à–∫—É: "Too Many Attempts"

### –¢–µ—Å—Ç–∏—Ä–∞—ö–µ Account Lockout-–∞:
1. –£–Ω–µ—Å–∏—Ç–µ –ø–æ–≥—Ä–µ—à–Ω—É –ª–æ–∑–∏–Ω–∫—É 5 –ø—É—Ç–∞
2. –¢—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ –≤–∏–¥–∏—Ç–µ: "–ù–∞–ª–æ–≥ —ò–µ –ø—Ä–∏–≤—Ä–µ–º–µ–Ω–æ –∑–∞–∫—ô—É—á–∞–Ω..."
3. –ó–∞ –æ—Ç–∫—ô—É—á–∞–≤–∞—ö–µ –Ω–∞–ª–æ–≥–∞ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ —ò–µ–¥–Ω—É –æ–¥ —Å–ª–µ–¥–µ—õ–∏—Ö –æ–ø—Ü–∏—ò–∞:
   - **–û–ø—Ü–∏—ò–∞ 1 (–ü—Ä–µ–ø–æ—Ä—É—á–µ–Ω–æ):** Artisan –∫–æ–º–∞–Ω–¥–∞
   - **–û–ø—Ü–∏—ò–∞ 2:** –î–∏—Ä–µ–∫—Ç–Ω–æ –∏–∑ –±–∞–∑–µ
   - **–û–ø—Ü–∏—ò–∞ 3:** –°–∞—á–µ–∫–∞—ò—Ç–µ 15 –º–∏–Ω—É—Ç–∞ (–∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ unlock)

### –¢–µ—Å—Ç–∏—Ä–∞—ö–µ Security Headers-–∞:
1. –û—Ç–≤–æ—Ä–∏—Ç–µ Developer Tools ‚Üí Network tab
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ Response Headers:
   - `Strict-Transport-Security`
   - `X-Frame-Options`
   - `X-Content-Type-Options`
   - `Content-Security-Policy`

---

## üìä –ù–û–í–ò –ë–ï–ó–ë–ï–î–ù–û–°–ù–ò –°–ö–û–†

| –ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞ | –ü—Ä–µ | –ü–æ—Å–ª–µ | –ù–∞–ø—Ä–µ–¥–∞–∫ |
|------------|-----|-------|----------|
| Password Security | 8/10 | 8/10 | - |
| Session Management | 7/10 | **9/10** | ‚úÖ +2 |
| CSRF Protection | 9/10 | 9/10 | - |
| Rate Limiting | **0/10** | **10/10** | ‚úÖ +10 |
| User Enumeration | **2/10** | **10/10** | ‚úÖ +8 |
| Account Lockout | **0/10** | **10/10** | ‚úÖ +10 |
| Security Headers | 3/10 | **9/10** | ‚úÖ +6 |

**–ù–æ–≤–∞ —É–∫—É–ø–Ω–∞ –æ—Ü–µ–Ω–∞: 9.3/10** üéâ

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û

1. **–û–±–∞–≤–µ–∑–Ω–æ –ø–æ–∫—Ä–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—ò—É** –ø—Ä–µ —Ç–µ—Å—Ç–∏—Ä–∞—ö–∞
2. **–ü—Ä–æ–º–µ–Ω–∏—Ç–µ SESSION_ENCRYPT —É production** –æ–∫—Ä—É–∂–µ—ö—É
3. **–û—á–∏—Å—Ç–∏—Ç–µ cache** –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–∞:
   ```bash
   php artisan cache:clear
   php artisan config:clear
   ```

---

## üîì –û–¢–ö–â–£–ß–ê–í–ê–ä–ï –ù–ê–õ–û–ì–ê

### –û–ø—Ü–∏—ò–∞ 1: Artisan –∫–æ–º–∞–Ω–¥–∞ (–ü—Ä–µ–ø–æ—Ä—É—á–µ–Ω–æ)

–ù–∞—ò—ò–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–∏—ò–∏ –Ω–∞—á–∏–Ω –∑–∞ –æ—Ç–∫—ô—É—á–∞–≤–∞—ö–µ –Ω–∞–ª–æ–≥–∞:

```bash
php artisan auth:unlock marko.radovanovic@suk.gov.rs
```

**–ù–∞–ø–æ–º–µ–Ω–∞:** –ö—É—á–∞—Ç–µ email **–ë–ï–ó –≤–∏—Ç–∏—á–∞—Å—Ç–∏—Ö –∑–∞–≥—Ä–∞–¥–∞** `{}`.

**–ü—Ä–∏–º–µ—Ä:**
```bash
# ‚úÖ –¢–ê–ß–ù–û
php artisan auth:unlock john.doe@example.com

# ‚ùå –ü–û–ì–†–ï–®–ù–û
php artisan auth:unlock {john.doe@example.com}
```

**–®—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–¥–∏:**
- –ü—Ä–æ–≤–µ—Ä–∞–≤–∞ –∫–æ–ª–∏–∫–æ –Ω–µ—É—Å–ø–µ–ª–∏—Ö –ø–æ–∫—É—à–∞—ò–∞ –ø–æ—Å—Ç–æ—ò–∏
- –ë—Ä–∏—à–µ —Å–≤–µ –Ω–µ—É—Å–ø–µ–ª–µ –ø–æ–∫—É—à–∞—ò–µ –∑–∞ –¥–∞—Ç–∏ email
- –ü—Ä–∏–∫–∞–∑—É—ò–µ –ø–æ—Ç–≤—Ä–¥—É —Å–∞ –±—Ä–æ—ò–µ–º –æ–±—Ä–∏—Å–∞–Ω–∏—Ö –ø–æ–∫—É—à–∞—ò–∞

**–ò–∑–ª–∞–∑ –∫–æ–º–∞–Ω–¥–µ:**
```
‚úì –ù–∞–ª–æ–≥ 'marko.radovanovic@suk.gov.rs' —ò–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫—ô—É—á–∞–Ω!
  –ë—Ä–æ—ò –æ–±—Ä–∏—Å–∞–Ω–∏—Ö –Ω–µ—É—Å–ø–µ–ª–∏—Ö –ø–æ–∫—É—à–∞—ò–∞: 5
```

### –û–ø—Ü–∏—ò–∞ 2: –î–∏—Ä–µ–∫—Ç–Ω–æ –∏–∑ –±–∞–∑–µ

–ê–∫–æ Artisan –∫–æ–º–∞–Ω–¥–∞ –Ω–∏—ò–µ –¥–æ—Å—Ç—É–ø–Ω–∞, –º–æ–∂–µ—Ç–µ —Ä—É—á–Ω–æ –æ–±—Ä–∏—Å–∞—Ç–∏ –∑–∞–ø–∏—Å–µ –∏–∑ –±–∞–∑–µ:

```sql
-- –û—Ç–∫—ô—É—á–∞–≤–∞—ö–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥ –Ω–∞–ª–æ–≥–∞
DELETE FROM failed_login_attempts
WHERE email = 'marko.radovanovic@suk.gov.rs';

-- –û—Ç–∫—ô—É—á–∞–≤–∞—ö–µ —Å–≤–∏—Ö –Ω–∞–ª–æ–≥–∞ (–æ—á–∏—Å—Ç–∏ —Ü–µ–ª—É —Ç–∞–±–µ–ª—É)
DELETE FROM failed_login_attempts;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –∫–æ–ª–∏–∫–æ –ø–æ–∫—É—à–∞—ò–∞ –∏–º–∞ –Ω–∞–ª–æ–≥
SELECT COUNT(*) as attempts
FROM failed_login_attempts
WHERE email = 'marko.radovanovic@suk.gov.rs'
AND attempted_at >= datetime('now', '-15 minutes');
```

**–ü—É—Ç–∞—ö–∞ –¥–æ SQLite –±–∞–∑–µ:**
```
database/database.sqlite
```

**–ê–ª–∞—Ç–∏ –∑–∞ –æ—Ç–≤–∞—Ä–∞—ö–µ SQLite –±–∞–∑–µ:**
- DB Browser for SQLite (https://sqlitebrowser.org/)
- DBeaver
- phpLiteAdmin
- VS Code SQLite Extension

---

## üîß MAINTENANCE

### –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ —á–∏—à—õ–µ—ö–µ —Å—Ç–∞—Ä–∏—Ö failed attempts:
–î–æ–¥–∞—ò—Ç–µ —É cron job –∏–ª–∏ scheduler:
```php
// app/Console/Kernel.php
$schedule->call(function () {
    app(LoginAttemptService::class)->cleanupOldAttempts();
})->hourly();
```

---

## üìñ –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–à–ê

–ó–∞ –≤–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞ –æ Laravel security best practices:
- https://laravel.com/docs/11.x/authentication
- https://laravel.com/docs/11.x/middleware
- https://owasp.org/www-project-top-ten/
